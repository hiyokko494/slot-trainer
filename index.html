
<!DOCTYPE html>
<html lang="ja">
<head>
  <meta charset="UTF-8" />
  <title>スロットゲーム修正版</title>
  <style>
    .reel-container {
      width: 100px;
      height: 300px;
      overflow: hidden;
      border: 2px solid black;
      margin: 10px;
      float: left;
      position: relative;
    }
    .reel {
  position: absolute;
  width: 100%;
  animation: none;
      position: absolute;
      width: 100%;
    }
    .symbol {
  transform: scale(0.9);
      height: 100px;
      line-height: 100px;
      text-align: center;
      font-size: 36px;
    }
    .blue { color: blue; }
    .red { color: red; }
    .black { color: black; }

    .result {
      position: absolute;
      top: 0;
      width: 100%;
      text-align: center;
      font-weight: bold;
      font-size: 24px;
    }

    .great { color: red; }
    .early { color: green; }
    .late { color: blue; }

    .buttons {
      clear: both;
      margin-top: 120px;
      text-align: center;
    }
  </style>
</head>
<body>
  <div class="reel-container"><div class="reel" id="reel1"></div><div class="result" id="result1"></div></div>
  <div class="reel-container"><div class="reel" id="reel2"></div><div class="result" id="result2"></div></div>
  <div class="reel-container"><div class="reel" id="reel3"></div><div class="result" id="result3"></div></div>

  <div class="buttons">
    <button onclick="stop(0)">STOP1</button>
    <button onclick="stop(1)">STOP2</button>
    <button onclick="stop(2)">STOP3</button>
    <br><br>
    <button onclick="start()">START</button>
  </div>

  <script>
    const symbols = [["", "", "7"], ["", "", "BAR"], ["", "", "7"]];
    const reels = [document.getElementById("reel1"), document.getElementById("reel2"), document.getElementById("reel3")];
    const results = [document.getElementById("result1"), document.getElementById("result2"), document.getElementById("result3")];
    const positions = [0, 0, 0];
    const intervalIds = [null, null, null];
    const targetPosition = 2; // 下段（3コマ目）

    function fillReel(reel, index) {
      reel.innerHTML = "";
      for (let i = 0; i < 21; i++) {
        const div = document.createElement("div");
        div.className = "symbol";
        if (i === 0) {
          div.textContent = symbols[index][2];
          div.classList.add(index === 0 ? "blue" : index === 1 ? "black" : "red");
        } else {
          div.textContent = "";
        }
        reel.appendChild(div);
      }
    }

    function start() {
      for (let i = 0; i < 3; i++) {
        fillReel(reels[i], i);
        let pos = 0;
        intervalIds[i] = setInterval(() => {
          pos = (pos + 1) % 21;
          reels[i].style.top = `${pos * 100}px`;
          positions[i] = pos;
        }, 1000 / 21);
        results[i].textContent = "";
      }
    }

    function stop(index) {
      clearInterval(intervalIds[index]);
      const stopped = positions[index];
      const diff = (stopped - targetPosition + 21) % 21;
      if (diff === 0) {
        results[index].textContent = "great!";
        results[index].className = "result great";
      } else if (diff <= 10) {
        results[index].textContent = `${diff}コマ遅い！`;
        results[index].className = "result late";
      } else {
        results[index].textContent = `${21 - diff}コマ早い！`;
        results[index].className = "result early";
      }
    }
  </script>
</body>
</html>
